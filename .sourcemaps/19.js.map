{"version":3,"sources":["../../src/pages/profile/editperson/editperson.page.module.ts","../../src/pages/profile/editperson/editperson.page.ts"],"names":[],"mappings":"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","file":"19.js","sourcesContent":["import { NgModule } from '@angular/core';\r\nimport { IonicPageModule } from 'ionic-angular';\r\n\r\nimport { EditPage } from './editperson.page';\r\nimport { NavModule } from '../../shared/nav';\r\n\r\n@NgModule({\r\n  declarations: [\r\n    EditPage\r\n  ],\r\n  imports: [\r\n    IonicPageModule.forChild(EditPage),\r\n\t\tNavModule\r\n  ],\r\n  entryComponents: [\r\n    EditPage\r\n  ]\r\n})\r\nexport class EditPageModule {}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/editperson/editperson.page.module.ts","import { Validators, FormControl, FormGroup } from '@angular/forms';\r\nimport { Component, DoCheck } from '@angular/core';\r\nimport { IonicPage, ToastController } from 'ionic-angular';\r\nimport { BackandService } from '@backand/angular2-sdk';\r\n\r\nimport { FormHandler, UserService, PictureService } from '../../../providers/myservices';\r\n\r\n@IonicPage({\r\n  name: 'edit'\r\n})\r\n@Component({\r\n  selector: 'page-edit',\r\n  templateUrl: 'editperson.page.html'\r\n})\r\n\r\nexport class EditPage implements DoCheck {\r\n  section: string = 'user';\r\n  signed: Object;\r\n  upFile: boolean = false;\r\n  passwordForm: FormGroup;\r\n  oldPass: FormControl = new FormControl('', Validators.required);\r\n  verify: FormGroup;\r\n  password: FormControl = new FormControl('', Validators.required);\r\n  confirm: FormControl = new FormControl('', Validators.required);\r\n  editForm: FormGroup;\r\n  firstName: FormControl = new FormControl('');\r\n  lastName: FormControl = new FormControl('');\r\n\r\n  constructor(public backand: BackandService,\r\n    public form: FormHandler,\r\n    public user: UserService,\r\n    public pic: PictureService,\r\n    public toast: ToastController) {\r\n    this.editForm = new FormGroup({\r\n      firstName: this.firstName,\r\n      lastName: this.lastName\r\n    });\r\n    this.verify = new FormGroup({\r\n      password: this.password,\r\n      confirm: this.confirm\r\n    }, form.areEqual);\r\n    this.passwordForm = new FormGroup({\r\n      oldPass: this.oldPass,\r\n      verify: this.verify\r\n    });\r\n  }\r\n\r\n  ngDoCheck() {\r\n    if (this.pic.newPic) {\r\n      this.user.myUser['pic'] = this.pic['picFile'];\r\n      this.upFile = true;\r\n    }\r\n  }\r\n\r\n  editInfo(info) {\r\n    let input = info.value;\r\n    for (let i in input) {\r\n      if (input[i] === '') {\r\n        delete input[i];\r\n        this.saveUpdate(input, info);\r\n      }\r\n    }\r\n  }\r\n\r\n  editPass(pass) {\r\n    let newPass = {\r\n      old: pass.value.oldPass,\r\n      new: pass.value.verify.password\r\n    };\r\n\r\n    this.backand.changePassword(newPass.old, newPass.new)\r\n      .then(data => {\r\n        this.form.clearForm(pass.controls.verify);\r\n        this.form.clearField(pass.controls.oldPass);\r\n        this.profileUpdated('Password');\r\n      })\r\n      .catch(err => {\r\n        this.errorToast(err._body);\r\n      });\r\n  }\r\n\r\n  errorToast(message) {\r\n    let errMess = this.toast.create({\r\n      message: message,\r\n      position: 'top',\r\n      duration: 5000\r\n    });\r\n\r\n    errMess.present();\r\n  }\r\n\r\n  profileUpdated(action: string) {\r\n    let editSuccess = this.toast.create({\r\n      message: `Your ${action} has been updated`,\r\n      position: 'top',\r\n      duration: 5000\r\n    });\r\n\r\n    editSuccess.present();\r\n  }\r\n\r\n  savePic() {\r\n    this.pic.getSigned('usersPic', this.user.myUser)\r\n      .subscribe(\r\n      data => {\r\n        this.signed = JSON.parse(data['_body']);\r\n      },\r\n      err => {\r\n        console.log(err);\r\n      },\r\n      () => {\r\n        this.pic.upload(this.signed, this.success);\r\n      });\r\n  }\r\n\r\n  saveUpdate(value, form?) {\r\n    let name = 'users';\r\n    let id = this.user.myUser['id'];\r\n    this.backand.object.update(name, id, value)\r\n      .then(data => {\r\n        this.user.getUser();\r\n        if (form) {\r\n          this.form.clearForm(form);\r\n          this.profileUpdated('Profile');\r\n        };\r\n      })\r\n      .catch(err => {\r\n        if (form) {\r\n          this.form.clearForm(form);\r\n        }\r\n      });\r\n  }\r\n\r\n  success = (result: any) => {\r\n    let finish = JSON.parse(result.response);\r\n    let image = {\r\n      pic: finish['url']\r\n    };\r\n    this.saveUpdate(image);\r\n    this.pic.picSaved();\r\n    this.upFile = false;\r\n  }\r\n}\n\n\n// WEBPACK FOOTER //\n// ./src/pages/profile/editperson/editperson.page.ts"],"sourceRoot":""}